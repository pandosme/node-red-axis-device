<script type="text/x-red" data-template-name="Axis Device">
    <div class="form-row">
        <label for="node-input-account"><i class="icon-tag"></i> Credentials</label>
        <input type="text" id="node-input-account">
    </div>
    <div class="form-row">
        <label for="node-input-address"><i class="icon-tag"></i> Address</label>
        <input type="text" id="node-input-address" placeholder="IP or FQDN">
    </div>
    <div class="form-row">
        <label for="node-input-action"><i class="icon-tag"></i> Action</label>
        <select id="node-input-action">
            <option value="Device Info">Device Info</option>
            <option value="Network settings">Network settings</option>
            <option value="HTTP Get">HTTP Get</option>
            <option value="HTTP Post">HTTP Post</option>
		</select>
	</div>
    <div class="form-row cgi_request">
        <label for="node-input-cgi"><i class="icon-tag"></i> CGI</label>
        <input type="text" id="node-input-cgi" placeholder="">
    </div>
    <div class="form-row cgi_request">
        <label for="node-input-data"><i class="icon-tag"></i> Data</label>
        <input type="text" id="node-input-data" placeholder="">
    </div>
</script>

<script type="text/javascript">
RED.nodes.registerType('Axis Device',{
	category: 'Axis',
	color: '#FFFF00',
	defaults: {
		account: {type:"axis-config"},
		address: {value:""},
		action: { value:"Device Info"},
		cgi: { value:""},
		data: {value:""}
	},
	icon: "camera-icon2.png",
	inputs:1,
	outputs:1,
	label: function() {
		return this.name || this.action;
	},
	oneditprepare: function() {
		$("#node-input-action").change(function() {
			var action = $("#node-input-action").val();
			switch (action) {
				case "Device Info":
				case "Device Info":
					$("#cgi_request").hide();
					$("#cgi_request").hide();
				break;
				case "HTTP Get":
				case "HTTP Post:
					$("#cgi_request").show();
					$("#cgi_request").show();
				break;
			}
		}
	}
});
</script>

<script type="text/x-red" data-help-name="Axis Device">
	<h3>Axis Device</h3>
	<h3>Inputs:</h3>
	<dl class="message-properties">
		<dt>credentials<span class="property-type">configuration</span></dt>
		<dd>Camera credentials are required.  User and password may be overriden by 
		<code>msg.user</code> and <code>msg.password</code></dd>
	</dl>	
	
	<dl class="message-properties">
		<dt>address<span class="property-type">string</span></dt>
		<dd>IP address or FQDN.  Address can be overriden using <code>msg.address</code></dd>
	</dl>	

	<dl class="message-properties">
		<dt>action<span class="property-type">string</span></dt>
		<dd>See list below.</dd>
	</dl>	

	<dl class="message-properties">
		<dt>msg.topic<span class="property-type">string | object</span></dt>
		<dd>Only used in selected actions</dd>
	</dl>	

	<dl class="message-properties">
		<dt>msg.url<span class="property-type">string | object</span></dt>
		<dd>Only used in HTTP POST</dd>
	</dl>	

	<dl class="message-properties">
		<dt>msg.payload<span class="property-type">string | object</span></dt>
		<dd>Payload depends on the action.  Setting <code>Payload</code> in the configuration will override 
		<code>msg.payload</code>.  Only use override when there is only one possible payload</dd>
	</dl>	

	<h3>Outputs:</h3>
	<dl class="message-properties">
		<dt>msg.error<span class="property-type">bool</span></dt>
		<dd>True if the action failed.  <code>msg.payload</code> may include clues on what was wrong.</dd>
	</dl>	

	<dl class="message-properties">
		<dt>msg.payload<span class="property-type">object | string | buffer</span></dt>
		<dd>Depends on action and output format</dd>
	</dl>	

	<h3>Info</h3>
	<p>Generel information about the camera</p>
	<dl class="message-properties">
		<dt>Output payload<span class="property-type">Object</span></dt>
		<dd> Camera properties</dd>
	</dl>	
	
	<h3>HTTP GET</h3>
	<p>To be used for VAPIX or ACAP API requests not supported by this node</p>
	<dl class="message-properties">
		<dt>payload<span class="property-type">string</span></dt>
		<dd>The URL path <i>e.g. /local/packages/someACAP/someAPI?name=john&age=31</i></dd>
	</dl>	

	<h3>HTTP POST</h3>
	<p>To be used for VAPIX or ACAP API requests not supported by this node</p>
	<dl class="message-properties">
		<dt>url<span class="property-type">string</span></dt>
		<dd>HTTP path to post data <i>e.g. /local/packages/someACAP/somePostAPI</i></dd>
	</dl>	

	<dl class="message-properties">
		<dt>payload<span class="property-type">string</span></dt>
		<dd>The body to post</dd>
	</dl>	

	<h3>GET PROPERTY</h3>
	<p>Read and parses the response to VAPIX param.cgi</p>
	<dl class="message-properties">
		<dt>payload<span class="property-type">string</span></dt>
		<dd> The camera parameter group path (without 'root.').</dd>
		<p><i>Examples: <code>network</code> or <code>network.eth0</code></i></p>
		<p>Common Groups: properties, brand, system, image, imagesource, audio, network, ptz, storage, time<br/>
		<i>See the VAPIX parameter documentation.</i></p>
	</dl>	

	<h3>SET PROPERTY</h3>
	<p>Sets and parses the response to VAPIX param.cgi</p>
	<dl class="message-properties">
		<dt>topic<span class="property-type">string</span></dt>
		<dd> The Axis parameter group path (without root).  Check VAPIX documentation.</dd>
		<dt>payload<span class="property-type">object</span></dt>
		<dd> An object with the properties to be set.  Note that sub group objects will NOT be set</dd>
	</dl>	
</script>
